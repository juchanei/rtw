# JWT - JSON Web Token
## Authorization
로그인 기능을 개발하기전 오해했던 부분이 있는데, 바로 Authentification(인증)과 Authorization(권한)이다. 한국어로는 완전히 다르게 읽히기 때문에 헛갈일 일이 없지만 영어로는 두 단어가 유사한 음절로 시작되어 나와 같이 익숙하지 않은 사람은 혼동하기도 한다. 간략하게 설명을 하면, 인증은 ID/PW나 공인인증서와 같이 어떠한 증빙을 통해 '내가 누구인가'를 확인하는 절차이고, 권한은 어떠한 '리소스에 접근할 수 있는가'를 여부를 파악하는 것이다. 따라서 로그인이라는 하나의 기능은 ID/PW를 통해 사용자를 인증하고 해당 사용자에게 부여 된 권한을 확인하여 리소스에 접근할 수 있도록 하는 것으로 볼 수 있다. JWT는 로그인을 구현하는데 많이 사용되며 그 중 권한을 주고 받는 것과 깊은 관련이 있다.

## Statefull 시스템
웹서비스의 요청과 응답을 담당하는 프로토콜인 HTTP는 TCP 위에서 동작하지만 TCP와 달리 연결간 상태를 유지하지 않는다 (stateless). 이는 웹이 초기 설계될 때 부터 분산 시스템을 고려하여 개발되었기 때문이다. 단일 서버의 경우 연결 간 상태를 비교적 쉽게 관리할 수 있는 반면, 분산 환경에서는 중앙집중적 상태 관리자 없이는 모든 서버가 상태를 공유하도록 만들기 어렵다.

그러나 웹서비스가 발달함에 따라 사용자에 따른 개인화가 필수적 요소로 부상하였다. 사용자가 모든 요청에 매번 로그인을 하는 것은 사용성을 너무나 해치기 때문에 이전에 로그인한 기록이 다음 요청에도 유지(statefull) 되어야만 한다. 이를 간단히 구현한 것이 '서버 기반 시스템'이다. 사용자가 로그인을 하면 서버는 해당 정보를 인증한 후 세션을 이용해 사용자에게 권한을 부여한다. 사용자는 한번 로그인하고 나면 모든 요청에 부여받은 세션을 포함시켜 서버가 이전에 부여했던 세션인지 알도록 해주면 된다. 문제는 '이전에 부여했던 세션'인지 확인한다는 것이 상태를 관리함을 의미한다는 것이다. 특히, 다수의 서버가 요청을 분산하여 처리하는 시스템이라면 각각의 서버가 부여한 세션이 Database와 같은 중앙집중적 세션 저장소에 관리되어야 한다. 만약 Database가 성능의 병목으로 작용한다면 서버 증설로도 성능 향상을 꾀하기 어려울 수 있다.

## 토큰 기반 시스템
'토큰 기반 시스템'은 서버에 상태를 유지하지 않고도 이전에 권한을 부여했는지 알 수 있도록 한다. 사용자가 로그인을 통해 신분을 인증하면 서버는 사용자의 권한 정보를 포함한 signed 토큰을 발급한다. 사용자가 다음 요청 부터 토큰을 포함시켜 보내면 서버는 자신이 sign한 토큰인지 확인한 뒤, 포함 된 권한 정보에 따라 리소스를 제공하면 된다. 토큰을 발행한 서버와 요청을 받은 서버가 같지 않더라도 유효한 토큰인지 확인하는 로직만 공유한다면 중앙집중적 시스템 없이도 개인화 기능을 구현할 수 있다. JWT는 토큰 기반 시스템의 구현체이며 웹 표준 RFC7519에 등록 되어있다.

## JWT
https://jwt.io/introduction/ 여기에 너무나 잘 소개되어있다. 직접 써보고 익숙해지면 추가로 작성할 예정.

## 궁금한 것
- 정말 세션 저장을 위해 Database를 쓰는 것이 성능의 병목으로 작용할까?
- JWT와 Bearer Token은 어떤 관계일까?
- JWT와 OAuth는 어떤 관계일까?
- 토큰을 전달하는데 HTTPS가 반드시 필요할까?